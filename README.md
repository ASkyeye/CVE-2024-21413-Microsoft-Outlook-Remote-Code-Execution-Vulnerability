# CVE-2024-21413 | Microsoft Outlook Remote Code Execution Vulnerability PoC

## üìú Description

This project presents a proof of concept (PoC) for CVE-2024-21413, a significant security vulnerability discovered in Microsoft Outlook with a CVSS of 9.8. Termed the #MonikerLink bug, this vulnerability has far-reaching implications, including the potential leakage of local NTLM information and the possibility of remote code execution. Moreover, it highlights an attack vector that could bypass Office Protected View, thereby extending its threat to other Office applications.

## üöÄ Usage

Use this tool responsibly and ensure you have authorization from the target system's owner. This script requires SMTP authentication to send an email, bypassing SPF, DKIM, and DMARC checks, which helps in simulating a real-world attack scenario more effectively.

\```bash
python CVE-2024-21413.py --server "<SMTP server>" --port <SMTP port> --username "<SMTP username>" --password "<SMTP password>" --sender "<sender email>" --recipient "<recipient email>" --url "<link URL>" --subject "<email subject>"
\```

**Parameters:**

- `--server`: SMTP server hostname or IP.
- `--port`: SMTP server port.
- `--username`: SMTP server username for authentication.
- `--password`: SMTP server password for authentication.
- `--sender`: Sender email address.
- `--recipient`: Recipient email address.
- `--url`: Link URL to include in the email.
- `--subject`: Email subject.

## üìÜ Changelog

### [16. February 2024] - Initial Release

- Initial release showcasing the exploit for CVE-2024-21413.

## Contributing

Contributions are welcome! Please feel free to fork the repository, make changes, and submit pull requests. If you encounter any issues or have suggestions for improvements, don't hesitate to open an issue.

## üìå Author

**Alexander Hagenah**
- [Website](https://primepage.de)
- [Twitter](https://twitter.com/xaitax)

## ‚ö†Ô∏è Disclaimer

This tool is intended for educational and ethical testing purposes only. Unauthorized scanning, testing, or exploiting of systems is illegal and unethical. Ensure you have explicit, authorized permission to engage in any testing or exploitation activities against target systems.

## üßê Why SMTP Authentication?

SMTP authentication is crucial for this demonstration to ensure the email sent bypasses common email validation checks such as SPF (Sender Policy Framework), DKIM (DomainKeys Identified Mail), and DMARC (Domain-based Message Authentication, Reporting, and Conformance). These security measures are designed to detect and prevent email spoofing, where attackers send emails from a forged address. By using authenticated SMTP, the demonstration closely mimics how a sophisticated attacker might circumvent these protections, making the testing environment more realistic and highlighting the importance of comprehensive email security practices.

## Demonstration Images

Replace `path/to/your/image.png` with the actual paths to your images once you upload them to a location accessible from the README, such as a GitHub repository.

### Initial Email Sending
![Initial Email Sending](path/to/your/image1.png)

### Received Mail in Outlook
![Received Mail in Outlook](path/to/your/image2.png)

### Wireshark Output
![Wireshark Output](path/to/your/image3.png)
